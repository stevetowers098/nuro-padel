name: Smart Service Deployment
on:
  push:
    branches: [docker-containers, main]

env:
  REGISTRY: ghcr.io
  IMAGE_PREFIX: ghcr.io/stevetowers098/nuro-padel

jobs:
  detect-changes:
    runs-on: ubuntu-latest
    outputs:
      yolo8: ${{ steps.changes.outputs.yolo8 }}
      yolo11: ${{ steps.changes.outputs.yolo11 }}
      mmpose: ${{ steps.changes.outputs.mmpose }}
      yolo-nas: ${{ steps.changes.outputs.yolo-nas }}
      vitpose: ${{ steps.changes.outputs.vitpose }}
      rf-detr: ${{ steps.changes.outputs.rf-detr }}
      nginx: ${{ steps.changes.outputs.nginx }}
    steps:
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v3
        
      - name: ğŸ” Detect changed services
        uses: dorny/paths-filter@v2
        id: changes
        with:
          filters: |
            yolo8:
              - 'services/yolo8/**'
            yolo11:
              - 'services/yolo11/**'
            mmpose:
              - 'services/mmpose/**'
            yolo-nas:
              - 'services/yolo-nas/**'
            vitpose:
              - 'services/vitpose/**'
            rf-detr:
              - 'services/rf-detr/**'
            nginx:
              - 'deployment/nginx.conf'
              - 'deployment/docker-compose.yml'
      
      - name: ğŸ“Š Log detected changes
        run: |
          echo "ğŸ” **CHANGE DETECTION RESULTS**"
          echo "================================="
          echo "YOLO8: ${{ steps.changes.outputs.yolo8 }}"
          echo "YOLO11: ${{ steps.changes.outputs.yolo11 }}"
          echo "MMPose: ${{ steps.changes.outputs.mmpose }}"
          echo "YOLO-NAS: ${{ steps.changes.outputs.yolo-nas }}"
          echo "ViTPose: ${{ steps.changes.outputs.vitpose }}"
          echo "RF-DETR: ${{ steps.changes.outputs.rf-detr }}"
          echo "Nginx: ${{ steps.changes.outputs.nginx }}"
          echo "================================="

  deploy-yolo8:
    needs: detect-changes
    if: needs.detect-changes.outputs.yolo8 == 'true'
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v3
      
      - name: ğŸ” Verify YOLO8 model requirements
        run: |
          echo "ğŸ” **YOLO8 MODEL WEIGHT VERIFICATION**"
          echo "================================="
          echo "ğŸ“‚ Checking Dockerfile for weight requirements..."
          
          if [ -f "services/yolo8/Dockerfile" ]; then
            echo "âœ… Dockerfile found"
            
            # Check if Dockerfile expects weights in specific paths
            if grep -q "/app/weights" services/yolo8/Dockerfile; then
              echo "âš ï¸  Dockerfile expects weights in /app/weights/"
              echo "ğŸ“ Service uses local file loading (no auto-download)"
              echo "âœ… Service has fallback mode for missing weights"
            else
              echo "â„¹ï¸  No explicit weight paths found in Dockerfile"
            fi
            
            # Check main.py for weight loading logic
            if grep -q "model_info.*fallback" services/yolo8/main.py; then
              echo "âœ… Service has fallback mode implemented"
            fi
            
            echo "âœ… YOLO8 weight verification complete"
          else
            echo "âŒ Dockerfile not found in services/yolo8/"
            exit 1
          fi
      
      - name: âš™ï¸ Set up Docker Buildx
        uses: docker/setup-buildx-action@v3
        
      - name: ğŸ” Log in to GitHub Container Registry
        uses: docker/login-action@v3
        with:
          registry: ${{ env.REGISTRY }}
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}
      
      - name: ğŸ“¦ Build and push YOLO8 image
        uses: docker/build-push-action@v5
        with:
          context: services/yolo8
          push: true
          tags: ${{ env.IMAGE_PREFIX }}/yolo8:latest
          cache-from: type=gha
          cache-to: type=gha,mode=max
        continue-on-error: false
        
      - name: ğŸ“Š Build success notification
        if: success()
        run: |
          echo "âœ… **YOLO8 BUILD SUCCESSFUL**"
          echo "================================="
          echo "ğŸ“¦ Image: ${{ env.IMAGE_PREFIX }}/yolo8:latest"
          echo "ğŸ·ï¸ Registry: ${{ env.REGISTRY }}"
          echo "ğŸ”— Image URL: https://github.com/stevetowers098/nuro-padel/pkgs/container/nuro-padel%2Fyolo8"
          echo "ğŸš€ Ready for deployment"
      
      - name: âŒ Build failure notification
        if: failure()
        run: |
          echo "âŒ **YOLO8 BUILD FAILED**"
          echo "================================="
          echo "ğŸš¨ Build process encountered errors"
          echo "ğŸ“ Check the build logs above for details"
          echo "ğŸ”§ Common fixes:"
          echo "   - Check Dockerfile syntax in services/yolo8/"
          echo "   - Verify base image availability"
          echo "   - Check for dependency conflicts"
          echo "   - Ensure model weights are accessible or fallback mode works"
          exit 1
      
      - name: ğŸš€ Deploy YOLO8 to VM - Start
        run: |
          echo "ğŸš€ **YOLO8 DEPLOYMENT START**"
          echo "================================="
          echo "âœ… Built and pushed: ${{ env.IMAGE_PREFIX }}/yolo8:latest"

      - name: ğŸ”Œ SSH Deploy YOLO8
        run: ssh padel-ai "cd /opt/padel-docker && docker-compose pull yolo8 && docker-compose up -d yolo8"

      - name: âœ… YOLO8 Deployment Completed
        run: echo "âœ… **YOLO8 DEPLOYMENT COMPLETED**"

  deploy-yolo11:
    needs: detect-changes
    if: needs.detect-changes.outputs.yolo11 == 'true'
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v3
      
      - name: ğŸ” Verify YOLO11 model requirements
        run: |
          echo "ğŸ” **YOLO11 MODEL WEIGHT VERIFICATION**"
          echo "================================="
          echo "ğŸ“‚ Checking Dockerfile for weight requirements..."
          
          if [ -f "services/yolo11/Dockerfile" ]; then
            echo "âœ… Dockerfile found"
            if grep -q "/app/weights" services/yolo11/Dockerfile; then
              echo "âš ï¸  Dockerfile expects weights in /app/weights/"
              echo "ğŸ“ Service uses local file loading (no auto-download)"
              echo "âœ… Service has fallback mode for missing weights"
            fi
            if grep -q "model_info.*fallback" services/yolo11/main.py; then
              echo "âœ… Service has fallback mode implemented"
            fi
            echo "âœ… YOLO11 weight verification complete"
          else
            echo "âŒ Dockerfile not found in services/yolo11/"
            exit 1
          fi
      
      - name: âš™ï¸ Set up Docker Buildx
        uses: docker/setup-buildx-action@v3
        
      - name: ğŸ” Log in to GitHub Container Registry
        uses: docker/login-action@v3
        with:
          registry: ${{ env.REGISTRY }}
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}
      
      - name: ğŸ“¦ Build and push YOLO11 image
        uses: docker/build-push-action@v5
        with:
          context: services/yolo11
          push: true
          tags: ${{ env.IMAGE_PREFIX }}/yolo11:latest
          cache-from: type=gha
          cache-to: type=gha,mode=max
        continue-on-error: false
        
      - name: ğŸ“Š Build success notification
        if: success()
        run: |
          echo "âœ… **YOLO11 BUILD SUCCESSFUL**"
          echo "================================="
          echo "ğŸ“¦ Image: ${{ env.IMAGE_PREFIX }}/yolo11:latest"
          echo "ğŸ·ï¸ Registry: ${{ env.REGISTRY }}"
          echo "ğŸ”— Image URL: https://github.com/stevetowers098/nuro-padel/pkgs/container/nuro-padel%2Fyolo11"
          echo "ğŸš€ Ready for deployment"
      
      - name: âŒ Build failure notification
        if: failure()
        run: |
          echo "âŒ **YOLO11 BUILD FAILED**"
          echo "================================="
          echo "ğŸš¨ Build process encountered errors"
          echo "ğŸ“ Check the build logs above for details"
          echo "ğŸ”§ Common fixes:"
          echo "   - Check Dockerfile syntax in services/yolo11/"
          echo "   - Verify ultralytics version compatibility"
          echo "   - Check for C3k2 dependency issues"
          echo "   - Ensure model weights are accessible or fallback mode works"
          exit 1
      
      - name: ğŸš€ Deploy YOLO11 to VM - Start
        run: |
          echo "ğŸš€ **YOLO11 DEPLOYMENT START**"
          echo "================================="
          echo "âœ… Built and pushed: ${{ env.IMAGE_PREFIX }}/yolo11:latest"

      - name: ğŸ”Œ SSH Deploy YOLO11
        run: ssh padel-ai "cd /opt/padel-docker && docker-compose pull yolo11 && docker-compose up -d yolo11"

      - name: âœ… YOLO11 Deployment Completed
        run: echo "âœ… **YOLO11 DEPLOYMENT COMPLETED**"

  deploy-mmpose:
    needs: detect-changes
    if: needs.detect-changes.outputs.mmpose == 'true'
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v3
      
      - name: ğŸ” Verify MMPose model requirements
        run: |
          echo "ğŸ” **MMPOSE MODEL WEIGHT VERIFICATION**"
          echo "================================="
          echo "ğŸ“‚ Checking MMPose service configuration..."
          
          if [ -f "services/mmpose/Dockerfile" ]; then
            echo "âœ… Dockerfile found"
            if grep -q "/app/weights" services/mmpose/Dockerfile; then
              echo "âš ï¸  Dockerfile expects weights in /app/weights/"
              echo "ğŸ“ Service uses local file loading (no auto-download)"
            fi
            if grep -q "MMPOSE_AVAILABLE.*False" services/mmpose/main.py; then
              echo "âœ… Service has MMPose fallback mode implemented"
            fi
            if grep -q "RTMPose.*HRNet" services/mmpose/main.py; then
              echo "âœ… Service supports RTMPose-M and HRNet-W48 models"
            fi
            echo "âœ… MMPose weight verification complete"
          else
            echo "âŒ Dockerfile not found in services/mmpose/"
            exit 1
          fi
      
      - name: âš™ï¸ Set up Docker Buildx
        uses: docker/setup-buildx-action@v3
        
      - name: ğŸ” Log in to GitHub Container Registry
        uses: docker/login-action@v3
        with:
          registry: ${{ env.REGISTRY }}
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}
      
      - name: ğŸ“¦ Build and push MMPose image
        uses: docker/build-push-action@v5
        with:
          context: services/mmpose
          push: true
          tags: ${{ env.IMAGE_PREFIX }}/mmpose:latest
          cache-from: type=gha
          cache-to: type=gha,mode=max
        continue-on-error: false
        
      - name: ğŸ“Š Build success notification
        if: success()
        run: |
          echo "âœ… **MMPOSE BUILD SUCCESSFUL**"
          echo "================================="
          echo "ğŸ“¦ Image: ${{ env.IMAGE_PREFIX }}/mmpose:latest"
          echo "ğŸ·ï¸ Registry: ${{ env.REGISTRY }}"
          echo "ğŸ”— Image URL: https://github.com/stevetowers098/nuro-padel/pkgs/container/nuro-padel%2Fmmpose"
          echo "ğŸš€ Ready for deployment"
      
      - name: âŒ Build failure notification
        if: failure()
        run: |
          echo "âŒ **MMPOSE BUILD FAILED**"
          echo "================================="
          echo "ğŸš¨ Build process encountered errors"
          echo "ğŸ“ Check the build logs above for details"
          echo "ğŸ”§ Common fixes:"
          echo "   - Check Dockerfile syntax in services/mmpose/"
          echo "   - Verify MMPose/mmcv installation compatibility"
          echo "   - Check for OpenCV conflicts"
          echo "   - Ensure RTMPose/HRNet weights are accessible or fallback mode works"
          exit 1
      
      - name: ğŸš€ Deploy MMPose to VM - Start
        run: |
          echo "ğŸš€ **MMPOSE DEPLOYMENT START**"
          echo "================================="
          echo "âœ… Built and pushed: ${{ env.IMAGE_PREFIX }}/mmpose:latest"

      - name: ğŸ”Œ SSH Deploy MMPose
        run: ssh padel-ai "cd /opt/padel-docker && docker-compose pull mmpose && docker-compose up -d mmpose"

      - name: âœ… MMPose Deployment Completed
        run: echo "âœ… **MMPOSE DEPLOYMENT COMPLETED**"

  deploy-yolo-nas:
    needs: detect-changes
    if: needs.detect-changes.outputs.yolo-nas == 'true'
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v3
      
      - name: ğŸ” Verify YOLO-NAS model requirements
        run: |
          echo "ğŸ” **YOLO-NAS MODEL WEIGHT VERIFICATION**"
          echo "================================="
          echo "ğŸ“‚ Checking YOLO-NAS service configuration..."
          
          if [ -f "services/yolo-nas/Dockerfile" ]; then
            echo "âœ… Dockerfile found"
            if grep -q "/app/weights" services/yolo-nas/Dockerfile; then
              echo "âš ï¸  Dockerfile expects weights in /app/weights/"
              echo "ğŸ“ Service uses local file loading (no auto-download)"
            fi
            if grep -q "SUPER_GRADIENTS_AVAILABLE.*False" services/yolo-nas/main.py; then
              echo "âœ… Service has Super Gradients fallback mode implemented"
            fi
            if grep -q "fallback.*model" services/yolo-nas/main.py; then
              echo "âœ… Service has pose/object model fallback implemented"
            fi
            echo "âœ… YOLO-NAS weight verification complete"
          else
            echo "âŒ Dockerfile not found in services/yolo-nas/"
            exit 1
          fi
      
      - name: âš™ï¸ Set up Docker Buildx
        uses: docker/setup-buildx-action@v3
        
      - name: ğŸ” Log in to GitHub Container Registry
        uses: docker/login-action@v3
        with:
          registry: ${{ env.REGISTRY }}
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}
      
      - name: ğŸ“¦ Build and push YOLO-NAS image
        uses: docker/build-push-action@v5
        with:
          context: services/yolo-nas
          push: true
          tags: ${{ env.IMAGE_PREFIX }}/yolo-nas:latest
          cache-from: type=gha
          cache-to: type=gha,mode=max
        continue-on-error: false
        
      - name: ğŸ“Š Build success notification
        if: success()
        run: |
          echo "âœ… **YOLO-NAS BUILD SUCCESSFUL**"
          echo "================================="
          echo "ğŸ“¦ Image: ${{ env.IMAGE_PREFIX }}/yolo-nas:latest"
          echo "ğŸ·ï¸ Registry: ${{ env.REGISTRY }}"
          echo "ğŸ”— Image URL: https://github.com/stevetowers098/nuro-padel/pkgs/container/nuro-padel%2Fyolo-nas"
          echo "ğŸš€ Ready for deployment"
      
      - name: âŒ Build failure notification
        if: failure()
        run: |
          echo "âŒ **YOLO-NAS BUILD FAILED**"
          echo "================================="
          echo "ğŸš¨ Build process encountered errors"
          echo "ğŸ“ Check the build logs above for details"
          echo "ğŸ”§ Common fixes:"
          echo "   - Check Dockerfile syntax in services/yolo-nas/"
          echo "   - Verify super-gradients installation"
          echo "   - Check for PyTorch compatibility issues"
          echo "   - Ensure model weights are accessible or fallback mode works"
          exit 1
      
      - name: ğŸš€ Deploy YOLO-NAS to VM - Start
        run: |
          echo "ğŸš€ **YOLO-NAS DEPLOYMENT START**"
          echo "================================="
          echo "âœ… Built and pushed: ${{ env.IMAGE_PREFIX }}/yolo-nas:latest"

      - name: ğŸ”Œ SSH Deploy YOLO-NAS
        run: ssh padel-ai "cd /opt/padel-docker && docker-compose pull yolo-nas && docker-compose up -d yolo-nas"

      - name: âœ… YOLO-NAS Deployment Completed
        run: echo "âœ… **YOLO-NAS DEPLOYMENT COMPLETED**"

  deploy-vitpose:
    needs: detect-changes
    if: needs.detect-changes.outputs.vitpose == 'true'
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v3
      
      - name: ğŸ” Verify ViTPose model requirements
        run: |
          echo "ğŸ” **VITPOSE++ MODEL WEIGHT VERIFICATION**"
          echo "================================="
          echo "ğŸ“‚ Checking ViTPose service configuration..."
          
          if [ -f "services/vitpose/Dockerfile" ]; then
            echo "âœ… Dockerfile found"
            if grep -q "/app/weights" services/vitpose/Dockerfile; then
              echo "âš ï¸  Dockerfile expects weights in /app/weights/"
              echo "ğŸ“ Service uses local file loading (no auto-download)"
            fi
            if grep -q "MMPOSE_AVAILABLE.*False" services/vitpose/main.py; then
              echo "âœ… Service has MMPose fallback mode implemented"
            fi
            if grep -q "ViTPose.*HRNet" services/vitpose/main.py; then
              echo "âœ… Service supports ViTPose-Base and HRNet-W48 models"
            fi
            if grep -q "FP16.*precision" services/vitpose/main.py; then
              echo "âœ… Service has FP16 memory optimization"
            fi
            echo "âœ… ViTPose weight verification complete"
          else
            echo "âŒ Dockerfile not found in services/vitpose/"
            exit 1
          fi
      
      - name: âš™ï¸ Set up Docker Buildx
        uses: docker/setup-buildx-action@v3
        
      - name: ğŸ” Log in to GitHub Container Registry
        uses: docker/login-action@v3
        with:
          registry: ${{ env.REGISTRY }}
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}
      
      - name: ğŸ“¦ Build and push ViTPose image
        uses: docker/build-push-action@v5
        with:
          context: services/vitpose
          push: true
          tags: ${{ env.IMAGE_PREFIX }}/vitpose:latest
          cache-from: type=gha
          cache-to: type=gha,mode=max
        continue-on-error: false
        
      - name: ğŸ“Š Build success notification
        if: success()
        run: |
          echo "âœ… **VITPOSE++ BUILD SUCCESSFUL**"
          echo "================================="
          echo "ğŸ“¦ Image: ${{ env.IMAGE_PREFIX }}/vitpose:latest"
          echo "ğŸ·ï¸ Registry: ${{ env.REGISTRY }}"
          echo "ğŸ”— Image URL: https://github.com/stevetowers098/nuro-padel/pkgs/container/nuro-padel%2Fvitpose"
          echo "ğŸš€ Ready for deployment"
      
      - name: âŒ Build failure notification
        if: failure()
        run: |
          echo "âŒ **VITPOSE++ BUILD FAILED**"
          echo "================================="
          echo "ğŸš¨ Build process encountered errors"
          echo "ğŸ“ Check the build logs above for details"
          echo "ğŸ”§ Common fixes:"
          echo "   - Check Dockerfile syntax in services/vitpose/"
          echo "   - Verify MMPose/mmcv installation compatibility"
          echo "   - Check for Vision Transformer dependencies"
          echo "   - Ensure ViTPose/HRNet weights are accessible or fallback mode works"
          exit 1
      
      - name: ğŸš€ Deploy ViTPose to VM - Start
        run: |
          echo "ğŸš€ **VITPOSE DEPLOYMENT START**"
          echo "================================="
          echo "âœ… Built and pushed: ${{ env.IMAGE_PREFIX }}/vitpose:latest"

      - name: ğŸ”Œ SSH Deploy ViTPose
        run: ssh padel-ai "cd /opt/padel-docker && docker-compose pull vitpose && docker-compose up -d vitpose"

      - name: âœ… ViTPose Deployment Completed
        run: echo "âœ… **VITPOSE DEPLOYMENT COMPLETED**"

  deploy-rf-detr:
    needs: detect-changes
    if: needs.detect-changes.outputs.rf-detr == 'true'
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v3
      
      - name: ğŸ” Verify RF-DETR model requirements
        run: |
          echo "ğŸ” **RF-DETR MODEL WEIGHT VERIFICATION**"
          echo "================================="
          echo "ğŸ“‚ Checking RF-DETR service configuration..."
          
          if [ -f "services/rf-detr/Dockerfile" ]; then
            echo "âœ… Dockerfile found"
            if grep -q "/app/weights" services/rf-detr/Dockerfile; then
              echo "âš ï¸  Dockerfile expects weights in /app/weights/"
              echo "ğŸ“ Service uses local file loading (no auto-download)"
            fi
            if grep -q "RF_DETR_AVAILABLE.*False" services/rf-detr/main.py; then
              echo "âœ… Service has RF-DETR fallback mode implemented"
            fi
            if grep -q "resolution.*56" services/rf-detr/main.py; then
              echo "âœ… Service has resolution constraint enforcement"
            fi
            if grep -q "FP16.*precision" services/rf-detr/main.py; then
              echo "âœ… Service has FP16 memory optimization"
            fi
            echo "âœ… RF-DETR weight verification complete"
          else
            echo "âŒ Dockerfile not found in services/rf-detr/"
            exit 1
          fi
      
      - name: âš™ï¸ Set up Docker Buildx
        uses: docker/setup-buildx-action@v3
        
      - name: ğŸ” Log in to GitHub Container Registry
        uses: docker/login-action@v3
        with:
          registry: ${{ env.REGISTRY }}
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}
      
      - name: ğŸ“¦ Build and push RF-DETR image
        uses: docker/build-push-action@v5
        with:
          context: services/rf-detr
          push: true
          tags: ${{ env.IMAGE_PREFIX }}/rf-detr:latest
          cache-from: type=gha
          cache-to: type=gha,mode=max
        continue-on-error: false
        
      - name: ğŸ“Š Build success notification
        if: success()
        run: |
          echo "âœ… **RF-DETR BUILD SUCCESSFUL**"
          echo "================================="
          echo "ğŸ“¦ Image: ${{ env.IMAGE_PREFIX }}/rf-detr:latest"
          echo "ğŸ·ï¸ Registry: ${{ env.REGISTRY }}"
          echo "ğŸ”— Image URL: https://github.com/stevetowers098/nuro-padel/pkgs/container/nuro-padel%2Frf-detr"
          echo "ğŸš€ Ready for deployment"
      
      - name: âŒ Build failure notification
        if: failure()
        run: |
          echo "âŒ **RF-DETR BUILD FAILED**"
          echo "================================="
          echo "ğŸš¨ Build process encountered errors"
          echo "ğŸ“ Check the build logs above for details"
          echo "ğŸ”§ Common fixes:"
          echo "   - Check Dockerfile syntax in services/rf-detr/"
          echo "   - Verify RF-DETR library installation"
          echo "   - Check for PyTorch/transformers compatibility"
          echo "   - Ensure RF-DETR weights are accessible or fallback mode works"
          exit 1
      
      - name: ğŸš€ Deploy RF-DETR to VM - Start
        run: |
          echo "ğŸš€ **RF-DETR DEPLOYMENT START**"
          echo "================================="
          echo "âœ… Built and pushed: ${{ env.IMAGE_PREFIX }}/rf-detr:latest"

      - name: ğŸ”Œ SSH Deploy RF-DETR
        run: ssh padel-ai "cd /opt/padel-docker && docker-compose pull rf-detr && docker-compose up -d rf-detr"

      - name: âœ… RF-DETR Deployment Completed
        run: echo "âœ… **RF-DETR DEPLOYMENT COMPLETED**"

  deploy-nginx:
    needs: detect-changes
    if: needs.detect-changes.outputs.nginx == 'true'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Deploy Nginx configuration - Start
        run: |
          echo "ğŸš€ **NGINX DEPLOYMENT START**"
          echo "================================="
          echo "ğŸ“„ Updated files: deployment/nginx.conf, deployment/docker-compose.yml"

      - name: ğŸ”Œ SSH Deploy Nginx
        run: ssh padel-ai "cd /opt/padel-docker && docker-compose up -d nginx"

      - name: âœ… Nginx Deployment Completed
        run: echo "âœ… **NGINX DEPLOYMENT COMPLETED**"